<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>malletma_web – Setup Dokumentation</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f1117;
      color: #e2e8f0;
      line-height: 1.7;
    }

    .sidebar {
      position: fixed;
      top: 0; left: 0;
      width: 260px;
      height: 100vh;
      background: #1a1d27;
      border-right: 1px solid #2d3148;
      overflow-y: auto;
      padding: 2rem 1rem;
    }

    .sidebar h2 {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #64748b;
      margin-bottom: 1rem;
    }

    .sidebar a {
      display: block;
      color: #94a3b8;
      text-decoration: none;
      font-size: 0.85rem;
      padding: 0.35rem 0.75rem;
      border-radius: 6px;
      margin-bottom: 2px;
      transition: background 0.15s, color 0.15s;
    }

    .sidebar a:hover { background: #2d3148; color: #e2e8f0; }

    .sidebar .section-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #475569;
      margin: 1.2rem 0 0.4rem 0.75rem;
    }

    .main {
      margin-left: 260px;
      padding: 3rem 4rem;
      max-width: 960px;
    }

    header {
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid #2d3148;
    }

    header .badge {
      display: inline-block;
      background: #1e3a5f;
      color: #60a5fa;
      font-size: 0.75rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      margin-bottom: 1rem;
    }

    header h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #f1f5f9;
    }

    header p {
      margin-top: 0.5rem;
      color: #94a3b8;
    }

    h2.section-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: #f1f5f9;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid #2d3148;
    }

    h3 {
      font-size: 1rem;
      font-weight: 600;
      color: #cbd5e1;
      margin: 1.5rem 0 0.5rem;
    }

    p { margin-bottom: 0.75rem; color: #94a3b8; }

    section { margin-bottom: 3.5rem; }

    .step {
      background: #1a1d27;
      border: 1px solid #2d3148;
      border-radius: 10px;
      padding: 1.25rem 1.5rem;
      margin-bottom: 1rem;
    }

    .step-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 1.6rem;
      height: 1.6rem;
      background: #1e3a5f;
      color: #60a5fa;
      font-size: 0.75rem;
      font-weight: 700;
      border-radius: 50%;
      margin-right: 0.6rem;
      flex-shrink: 0;
    }

    .step-header {
      display: flex;
      align-items: center;
      font-weight: 600;
      color: #e2e8f0;
      margin-bottom: 0.5rem;
    }

    .step p { margin-bottom: 0; }

    pre {
      background: #0d1117;
      border: 1px solid #2d3148;
      border-radius: 8px;
      padding: 1rem 1.25rem;
      overflow-x: auto;
      margin: 0.75rem 0;
      font-size: 0.82rem;
    }

    code {
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      color: #7dd3fc;
    }

    pre code { color: #e2e8f0; }

    .keyword { color: #c084fc; }
    .string  { color: #86efac; }
    .comment { color: #4b5563; font-style: italic; }
    .tag     { color: #fb923c; }
    .attr    { color: #60a5fa; }

    .info-box {
      background: #1e3a5f22;
      border-left: 3px solid #3b82f6;
      border-radius: 0 8px 8px 0;
      padding: 0.75rem 1rem;
      margin: 0.75rem 0;
      font-size: 0.875rem;
      color: #93c5fd;
    }

    .warning-box {
      background: #78350f22;
      border-left: 3px solid #f59e0b;
      border-radius: 0 8px 8px 0;
      padding: 0.75rem 1rem;
      margin: 0.75rem 0;
      font-size: 0.875rem;
      color: #fcd34d;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
      margin: 1rem 0;
    }

    th {
      text-align: left;
      background: #1a1d27;
      color: #94a3b8;
      font-weight: 600;
      padding: 0.6rem 1rem;
      border-bottom: 1px solid #2d3148;
    }

    td {
      padding: 0.6rem 1rem;
      border-bottom: 1px solid #1e2235;
      color: #cbd5e1;
      vertical-align: top;
    }

    td code { color: #7dd3fc; font-size: 0.8rem; }

    .tag-pill {
      display: inline-block;
      font-size: 0.7rem;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      font-weight: 600;
      margin-left: 0.4rem;
    }

    .pill-green  { background: #14532d44; color: #4ade80; }
    .pill-blue   { background: #1e3a5f44; color: #60a5fa; }
    .pill-orange { background: #78350f44; color: #fb923c; }

    .arch-diagram {
      background: #0d1117;
      border: 1px solid #2d3148;
      border-radius: 10px;
      padding: 1.5rem 2rem;
      font-family: monospace;
      font-size: 0.82rem;
      color: #94a3b8;
      line-height: 2;
    }

    .arch-diagram .highlight { color: #60a5fa; font-weight: 700; }
    .arch-diagram .arrow     { color: #4b5563; }

    .toc-top {
      font-size: 0.75rem;
      color: #3b82f6;
      text-decoration: none;
      float: right;
      margin-top: 0.2rem;
    }
  </style>
</head>
<body>

<!-- Sidebar -->
<nav class="sidebar">
  <h2>Inhalt</h2>
  <a href="#uebersicht">Übersicht</a>
  <a href="#architektur">Architektur</a>

  <div class="section-label">Setup</div>
  <a href="#phase1">1 · Projekt & Vite</a>
  <a href="#phase2">2 · GitHub</a>
  <a href="#phase3">3 · Vercel</a>
  <a href="#phase4">4 · Auth0</a>
  <a href="#phase5">5 · Code – Middleware</a>
  <a href="#phase6">6 · Code – Auth-Routen</a>
  <a href="#phase7">7 · Logout-Button</a>

  <div class="section-label">Referenz</div>
  <a href="#env-vars">Umgebungsvariablen</a>
  <a href="#files">Dateiübersicht</a>
  <a href="#flow">Login-Flow</a>
</nav>

<!-- Main content -->
<main class="main">

  <header id="uebersicht">
    <div class="badge">Erstellt 22. Februar 2026</div>
    <h1>malletma_web – Setup Dokumentation</h1>
    <p>Vollständige Dokumentation des Projekts: statische Vite-Site mit Auth0-Login, deployt auf Vercel via GitHub.</p>
  </header>

  <!-- Architektur -->
  <section id="architektur">
    <h2 class="section-title">Architektur <a href="#uebersicht" class="toc-top">↑ oben</a></h2>
    <div class="arch-diagram">
      <span class="highlight">Browser</span>
      <span class="arrow"> → </span>
      <span class="highlight">Vercel Edge Middleware</span> (prüft session-Cookie)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓ kein gültiger Cookie<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<span class="highlight">/api/auth/login</span>
      <span class="arrow"> → </span>
      <span class="highlight">Auth0</span>
      <span class="arrow"> → </span>
      E-Mail + Passwort Login<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓ Erfolg (OAuth Code)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<span class="highlight">/api/auth/callback</span>
      <span class="arrow"> → </span>
      JWT-Cookie setzen
      <span class="arrow"> → </span>
      redirect /<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↓ gültiger Cookie vorhanden<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<span class="highlight">Statische Site wird ausgeliefert</span>
    </div>

    <div class="info-box">
      Die gesamte Absicherung läuft im Edge-Netzwerk von Vercel — Seiteninhalt wird niemals an nicht eingeloggte Benutzer ausgeliefert.
    </div>
  </section>

  <!-- Phase 1: Projekt -->
  <section id="phase1">
    <h2 class="section-title">Phase 1 · Projekt &amp; Vite <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <div class="step">
      <div class="step-header"><span class="step-number">1</span>Vite-Projekt erstellen</div>
      <p>Vanilla JavaScript Template mit Vite 7:</p>
      <pre><code>npm create vite@latest malletma_web -- --template vanilla
cd ~/Dev/malletma_web
npm install</code></pre>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">2</span>vite.config.js anpassen</div>
      <p>Base-Pfad auf <code>/</code> setzen (für Vercel-Deployment):</p>
      <pre><code><span class="keyword">export default</span> {
  base: <span class="string">'/'</span>,
}</code></pre>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">3</span>Abhängigkeiten installieren</div>
      <pre><code>npm install jose @vercel/edge</code></pre>
      <p>
        <code>jose</code> – Edge-kompatible JWT-Bibliothek (zum Signieren des Session-Cookies)<br>
        <code>@vercel/edge</code> – Hilfsfunktionen für Vercel Edge Middleware (<code>next()</code>)
      </p>
    </div>
  </section>

  <!-- Phase 2: GitHub -->
  <section id="phase2">
    <h2 class="section-title">Phase 2 · GitHub <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <div class="step">
      <div class="step-header"><span class="step-number">1</span>SSH-Key erstellen</div>
      <pre><code>ssh-keygen -t ed25519 -C "github" -f ~/.ssh/id_ed25519
cat ~/.ssh/id_ed25519.pub   <span class="comment"># Public Key kopieren → GitHub einfügen</span></code></pre>
      <p>Danach in GitHub → Settings → SSH and GPG Keys → New SSH Key einfügen.</p>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">2</span>Repo anlegen &amp; verbinden</div>
      <pre><code><span class="comment"># Repo auf github.com manuell erstellt: malletma911/malletma_web</span>
git init
git remote add origin git@github.com:malletma911/malletma_web.git
git add .
git commit -m "Initial commit"
git push -u origin main</code></pre>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">3</span>GitHub Pages deaktiviert</div>
      <p>GitHub → Repository → Settings → Pages → Source: <strong>None</strong> gespeichert.</p>
      <p>Der GitHub Actions Workflow <code>.github/workflows/deploy.yml</code> wurde gelöscht.</p>
    </div>
  </section>

  <!-- Phase 3: Vercel -->
  <section id="phase3">
    <h2 class="section-title">Phase 3 · Vercel <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <div class="step">
      <div class="step-header"><span class="step-number">1</span>Vercel-Projekt erstellen (Browser)</div>
      <p>vercel.com → New Project → GitHub-Repo <code>malletma911/malletma_web</code> importieren → Deploy.</p>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">2</span>Auto-Deploy aktiviert</div>
      <p>Jeder <code>git push</code> auf <code>main</code> löst automatisch einen neuen Vercel-Build aus.</p>
      <div class="info-box">
        Deploy-Ablauf: <strong>git push → GitHub → Vercel erkennt Push → Build → Deploy</strong>
      </div>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">3</span>Umgebungsvariablen setzen</div>
      <p>Vercel Dashboard → Projekt → Settings → Environment Variables:</p>
      <table>
        <tr><th>Variable</th><th>Beschreibung</th></tr>
        <tr><td><code>AUTH0_DOMAIN</code></td><td>z. B. <code>dev-xxxx.eu.auth0.com</code></td></tr>
        <tr><td><code>AUTH0_CLIENT_ID</code></td><td>Aus Auth0 Dashboard</td></tr>
        <tr><td><code>AUTH0_CLIENT_SECRET</code></td><td>Aus Auth0 Dashboard</td></tr>
        <tr><td><code>AUTH0_BASE_URL</code></td><td>z. B. <code>https://malletma-web.vercel.app</code></td></tr>
        <tr><td><code>AUTH0_SECRET</code></td><td>Zufallswert: <code>openssl rand -hex 32</code></td></tr>
      </table>
    </div>
  </section>

  <!-- Phase 4: Auth0 -->
  <section id="phase4">
    <h2 class="section-title">Phase 4 · Auth0 <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <div class="step">
      <div class="step-header"><span class="step-number">1</span>Auth0-Konto &amp; Anwendung erstellen</div>
      <p>auth0.com → Create Account → Applications → Create Application:</p>
      <ul style="color:#94a3b8; padding-left:1.5rem; margin-top:0.5rem;">
        <li>Name: <code>malletma_web</code></li>
        <li>Typ: <strong>Regular Web Application</strong></li>
      </ul>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">2</span>Callback- &amp; Logout-URLs eintragen</div>
      <p>Auth0 → Applications → malletma_web → Settings:</p>
      <table>
        <tr><th>Feld</th><th>Wert</th></tr>
        <tr><td>Allowed Callback URLs</td><td><code>https://malletma-web.vercel.app/api/auth/callback</code></td></tr>
        <tr><td>Allowed Logout URLs</td><td><code>https://malletma-web.vercel.app</code></td></tr>
      </table>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">3</span>Datenbankverbindung aktivieren</div>
      <p>Auth0 → Authentication → Database → <code>Username-Password-Authentication</code> → Applications-Tab → <strong>malletma_web einschalten</strong>.</p>
    </div>

    <div class="step">
      <div class="step-header"><span class="step-number">4</span>Benutzer anlegen</div>
      <p>Auth0 → User Management → Users → Create User:</p>
      <ul style="color:#94a3b8; padding-left:1.5rem; margin-top:0.5rem;">
        <li>E-Mail + Passwort eingeben</li>
        <li>Connection: <code>Username-Password-Authentication</code></li>
      </ul>
      <div class="info-box">
        Weitere Benutzer können jederzeit so hinzugefügt oder gesperrt werden — ohne Code-Änderungen.
      </div>
    </div>
  </section>

  <!-- Phase 5: Middleware -->
  <section id="phase5">
    <h2 class="section-title">Phase 5 · Code – Middleware <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <p>Datei: <code>middleware.js</code> (Projekt-Root). Läuft auf jedem Request im Vercel Edge Network.</p>

    <pre><code><span class="keyword">import</span> { next } <span class="keyword">from</span> <span class="string">'@vercel/edge'</span>

<span class="keyword">export default function</span> middleware(request) {
  <span class="keyword">const</span> url = <span class="keyword">new</span> URL(request.url)

  <span class="comment">// Auth-Routen immer durchlassen</span>
  <span class="keyword">if</span> (url.pathname.startsWith(<span class="string">'/api/'</span>)) {
    <span class="keyword">return</span> next()
  }

  <span class="comment">// Session-Cookie prüfen</span>
  <span class="keyword">const</span> cookieHeader = request.headers.get(<span class="string">'cookie'</span>) || <span class="string">''</span>
  <span class="keyword">const</span> hasSession = cookieHeader.split(<span class="string">';'</span>).some(c => c.trim().startsWith(<span class="string">'session='</span>))

  <span class="keyword">if</span> (!hasSession) {
    <span class="keyword">return</span> Response.redirect(<span class="keyword">new</span> URL(<span class="string">'/api/auth/login'</span>, request.url))
  }

  <span class="keyword">return</span> next()
}</code></pre>

    <div class="warning-box">
      Wichtig: <code>request.cookies.get()</code> ist eine Next.js-API und funktioniert in Vercel Edge nicht ohne Next.js. Deshalb wird der Cookie-Header manuell über <code>request.headers.get('cookie')</code> ausgelesen.
    </div>
  </section>

  <!-- Phase 6: Auth-Routen -->
  <section id="phase6">
    <h2 class="section-title">Phase 6 · Code – Auth-Routen <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <h3>api/auth/login.js</h3>
    <p>Leitet den Browser zur Auth0-Login-Seite weiter.</p>
    <pre><code><span class="keyword">export const</span> config = { runtime: <span class="string">'edge'</span> }

<span class="keyword">export default function</span> handler(request) {
  <span class="keyword">const</span> params = <span class="keyword">new</span> URLSearchParams({
    response_type: <span class="string">'code'</span>,
    client_id: process.env.AUTH0_CLIENT_ID,
    redirect_uri: <span class="string">`${</span>process.env.AUTH0_BASE_URL<span class="string">}/api/auth/callback`</span>,
    scope: <span class="string">'openid profile email'</span>,
  })
  <span class="keyword">return</span> Response.redirect(
    <span class="string">`https://${</span>process.env.AUTH0_DOMAIN<span class="string">}/authorize?${</span>params<span class="string">}`</span>
  )
}</code></pre>

    <h3>api/auth/callback.js</h3>
    <p>Empfängt den OAuth-Code von Auth0, tauscht ihn gegen Tokens, holt Nutzerinfos und setzt einen signierten JWT-Cookie (8 Stunden gültig).</p>
    <pre><code><span class="keyword">import</span> { SignJWT } <span class="keyword">from</span> <span class="string">'jose'</span>

<span class="keyword">export const</span> config = { runtime: <span class="string">'edge'</span> }

<span class="keyword">export default async function</span> handler(request) {
  <span class="keyword">const</span> code = <span class="keyword">new</span> URL(request.url).searchParams.get(<span class="string">'code'</span>)
  <span class="keyword">if</span> (!code) <span class="keyword">return new</span> Response(<span class="string">'Missing code'</span>, { status: 400 })

  <span class="comment">// OAuth-Code gegen Tokens tauschen</span>
  <span class="keyword">const</span> tokenRes = <span class="keyword">await</span> fetch(<span class="string">`https://${</span>process.env.AUTH0_DOMAIN<span class="string">}/oauth/token`</span>, {
    method: <span class="string">'POST'</span>,
    headers: { <span class="string">'content-type'</span>: <span class="string">'application/json'</span> },
    body: JSON.stringify({
      grant_type: <span class="string">'authorization_code'</span>,
      client_id: process.env.AUTH0_CLIENT_ID,
      client_secret: process.env.AUTH0_CLIENT_SECRET,
      code,
      redirect_uri: <span class="string">`${</span>process.env.AUTH0_BASE_URL<span class="string">}/api/auth/callback`</span>,
    }),
  })
  <span class="keyword">const</span> tokens = <span class="keyword">await</span> tokenRes.json()
  <span class="keyword">if</span> (!tokenRes.ok) <span class="keyword">return new</span> Response(<span class="string">'Authentication failed'</span>, { status: 401 })

  <span class="comment">// Nutzerinfo holen</span>
  <span class="keyword">const</span> user = <span class="keyword">await</span> fetch(<span class="string">`https://${</span>process.env.AUTH0_DOMAIN<span class="string">}/userinfo`</span>, {
    headers: { Authorization: <span class="string">`Bearer ${</span>tokens.access_token<span class="string">}`</span> },
  }).then(r => r.json())

  <span class="comment">// Signierten JWT-Cookie erstellen</span>
  <span class="keyword">const</span> secret = <span class="keyword">new</span> TextEncoder().encode(process.env.AUTH0_SECRET)
  <span class="keyword">const</span> session = <span class="keyword">await new</span> SignJWT({ email: user.email, name: user.name })
    .setProtectedHeader({ alg: <span class="string">'HS256'</span> })
    .setExpirationTime(<span class="string">'8h'</span>)
    .sign(secret)

  <span class="keyword">return new</span> Response(<span class="keyword">null</span>, {
    status: 302,
    headers: {
      Location: <span class="string">'/'</span>,
      <span class="string">'Set-Cookie'</span>: <span class="string">`session=${</span>session<span class="string">}; HttpOnly; Secure; SameSite=Lax; Path=/; Max-Age=28800`</span>,
    },
  })
}</code></pre>

    <h3>api/auth/logout.js</h3>
    <p>Löscht den Session-Cookie und leitet zur Auth0-Logout-URL weiter.</p>
    <pre><code><span class="keyword">export const</span> config = { runtime: <span class="string">'edge'</span> }

<span class="keyword">export default function</span> handler() {
  <span class="keyword">const</span> params = <span class="keyword">new</span> URLSearchParams({
    client_id: process.env.AUTH0_CLIENT_ID,
    returnTo: process.env.AUTH0_BASE_URL,
  })
  <span class="keyword">return new</span> Response(<span class="keyword">null</span>, {
    status: 302,
    headers: {
      Location: <span class="string">`https://${</span>process.env.AUTH0_DOMAIN<span class="string">}/v2/logout?${</span>params<span class="string">}`</span>,
      <span class="string">'Set-Cookie'</span>: <span class="string">'session=; HttpOnly; Secure; SameSite=Lax; Path=/; Max-Age=0'</span>,
    },
  })
}</code></pre>
  </section>

  <!-- Phase 7: Logout-Button -->
  <section id="phase7">
    <h2 class="section-title">Phase 7 · Logout-Button <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <p>In <code>src/main.js</code> wurde ein Logout-Button oben rechts hinzugefügt:</p>

    <pre><code><span class="comment">// Oben rechts fixiert</span>
<span class="string">`&lt;div style="position:fixed;top:1rem;right:1rem;"&gt;
  &lt;a href="/api/auth/logout"&gt;
    &lt;button type="button"&gt;Logout&lt;/button&gt;
  &lt;/a&gt;
&lt;/div&gt;`</span></code></pre>

    <p>Ein Klick auf den Button ruft <code>/api/auth/logout</code> auf → Cookie wird gelöscht → Weiterleitung zur Auth0-Abmeldeseite.</p>
  </section>

  <!-- Referenz: Env Vars -->
  <section id="env-vars">
    <h2 class="section-title">Referenz – Umgebungsvariablen <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <table>
      <tr><th>Variable</th><th>Wo zu finden</th><th>Beispiel</th></tr>
      <tr>
        <td><code>AUTH0_DOMAIN</code></td>
        <td>Auth0 → Applications → Settings</td>
        <td><code>dev-abc123.eu.auth0.com</code></td>
      </tr>
      <tr>
        <td><code>AUTH0_CLIENT_ID</code></td>
        <td>Auth0 → Applications → Settings</td>
        <td><code>Abc123XYZ…</code></td>
      </tr>
      <tr>
        <td><code>AUTH0_CLIENT_SECRET</code></td>
        <td>Auth0 → Applications → Settings</td>
        <td><code>sehr-geheim…</code></td>
      </tr>
      <tr>
        <td><code>AUTH0_BASE_URL</code></td>
        <td>Deine Vercel-URL</td>
        <td><code>https://malletma-web.vercel.app</code></td>
      </tr>
      <tr>
        <td><code>AUTH0_SECRET</code></td>
        <td>Selbst generiert</td>
        <td><code>openssl rand -hex 32</code></td>
      </tr>
    </table>

    <div class="warning-box">
      Diese Werte niemals in den Code einchecken! Sie sind ausschließlich in den Vercel Environment Variables gespeichert.
    </div>
  </section>

  <!-- Referenz: Dateien -->
  <section id="files">
    <h2 class="section-title">Referenz – Dateiübersicht <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <table>
      <tr><th>Datei</th><th>Zweck</th><th>Status</th></tr>
      <tr><td><code>vite.config.js</code></td><td>Vite-Konfiguration, base: '/'</td><td><span class="tag-pill pill-blue">geändert</span></td></tr>
      <tr><td><code>middleware.js</code></td><td>Edge Auth-Gate für alle Routen</td><td><span class="tag-pill pill-green">neu</span></td></tr>
      <tr><td><code>api/auth/login.js</code></td><td>Redirect zu Auth0</td><td><span class="tag-pill pill-green">neu</span></td></tr>
      <tr><td><code>api/auth/callback.js</code></td><td>OAuth-Callback, JWT-Cookie setzen</td><td><span class="tag-pill pill-green">neu</span></td></tr>
      <tr><td><code>api/auth/logout.js</code></td><td>Cookie löschen, Auth0-Logout</td><td><span class="tag-pill pill-green">neu</span></td></tr>
      <tr><td><code>src/main.js</code></td><td>Hauptseite + Logout-Button</td><td><span class="tag-pill pill-blue">geändert</span></td></tr>
      <tr><td><code>package.json</code></td><td>jose + @vercel/edge hinzugefügt</td><td><span class="tag-pill pill-blue">geändert</span></td></tr>
      <tr><td><code>.github/workflows/deploy.yml</code></td><td>GitHub Pages Workflow</td><td><span class="tag-pill pill-orange">gelöscht</span></td></tr>
    </table>
  </section>

  <!-- Referenz: Flow -->
  <section id="flow">
    <h2 class="section-title">Referenz – Vollständiger Login-Flow <a href="#uebersicht" class="toc-top">↑ oben</a></h2>

    <div class="step">
      <div class="step-header"><span class="step-number">1</span>Browser ruft Vercel-URL auf</div>
      <p>Middleware prüft: Gibt es einen <code>session</code>-Cookie?</p>
    </div>
    <div class="step">
      <div class="step-header"><span class="step-number">2</span>Kein Cookie → Redirect zu /api/auth/login</div>
      <p>Login-Handler baut Auth0-URL und redirected den Browser.</p>
    </div>
    <div class="step">
      <div class="step-header"><span class="step-number">3</span>Auth0 zeigt Login-Formular</div>
      <p>Benutzer gibt E-Mail + Passwort ein (aus Auth0 User Management).</p>
    </div>
    <div class="step">
      <div class="step-header"><span class="step-number">4</span>Auth0 redirected zu /api/auth/callback mit Code</div>
      <p>Callback-Handler tauscht Code gegen Access Token, holt Nutzerinfos, erstellt JWT und setzt Cookie.</p>
    </div>
    <div class="step">
      <div class="step-header"><span class="step-number">5</span>Redirect zu / — Site wird geladen</div>
      <p>Middleware sieht jetzt den gültigen Cookie und lässt den Request durch.</p>
    </div>
    <div class="step">
      <div class="step-header"><span class="step-number">6</span>Logout-Button geklickt</div>
      <p>/api/auth/logout löscht den Cookie und leitet zu Auth0-Logout weiter → zurück zum Login.</p>
    </div>
  </section>

</main>
</body>
</html>
